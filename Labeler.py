#################################################################
#																#
# -Project:		Prevalence of Types of ASEPs in Windows malware #
# -File:		Analyzer.py										#
# -Author:		Carlos Borau Gonz√°lez | NIP: 778280				#
# -Description: Manages the parsing of malware sample behavior	#
#					and the labeling of said sample based on	#
#					the results of this process					#
#																#
#################################################################

# Utility imports
import enum

# RPC comunication imports
import xmlrpc.server as srv
import xmlrpc.client as cli

class LabelerMode(enum.Enum):

    Local = 0
    Remote = 1
    

class Labeler:


	def __init__(self, mode, master_addr=None):
	
		if not (mode.name in LabelerMode.__members__):
			print("Labeler mode not known:", mode)
			exit()
			
		self.Mode = mode
		
		if self.Mode == LabelerMode.Remote:
			self.Master = cli.ServerProxy('http://{0}/'.format(master_addr)) 
		
	
	def SubmitLog(self, path):
	
		if self.Mode == LabelerMode.Remote:
			log_f = self.Master.requestFile(path)
		else:
			log_f = open(path, "rb")
			
		log = log_f.read()
		
		
		# TODO parse log and generate results
			
		results = log
		
		return results
