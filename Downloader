#!/usr/bin/python3.8

# Utility imports
import argparse
import os

# Workflow components imports
from Digester import Digester

#########################################################
#														#
#						Main Code						#
#														#
#########################################################

def main(args):


	analyzedSamples = [os.path.splitext(zipName)[0] for zipName in os.listdir(args.resultsDir)]
	processedSamples = [os.path.splitext(sample)[0] for sample in os.listdir(args.samplesDir)]
	
	digester = Digester('.', args.samplesDir, analyzedSamples + processedSamples)
	
	digester.download(args.since)


#########################################################
#														#
#					Argument Parsing					#
#														#
#########################################################


if __name__ == "__main__":

	parser = argparse.ArgumentParser(description="Download samples to analyze")
	parser.add_argument("--samplesDir", help="Directory in which to download samples", required=True)
	parser.add_argument("--resultsDir", help="Directory in which analysis results are stored", required=True)
	parser.add_argument("--since", help="Moment since which download samples", required=True, choices=['Last-Hour', 'Last-2-Days'])	
	args = parser.parse_args()

	main(args)
